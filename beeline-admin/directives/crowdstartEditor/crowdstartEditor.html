<div class="container-fluid crowdstart-editor">
  <form class="container-fluid form-horizontal" ng-submit="save()">

    <div class="form-group form-inline">
      <label>
        Route Passes per Bid
        <input type="number" ng-model="editRoute.notes.noPasses"
          class="form-control" />
      </label>
    </div>

    <div class="form-group">
      <label>
        Campaign end date
      </label>

      <div class="input-group">
        <input type="text" class="form-control" uib-datepicker-popup="dd-MMM-yyyy"
          ng-model="editRoute._meta.campaignEndDate"
          ng-model-options="{timezone: '+0800'}"
          is-open="disp.campaignEndPopupOpen">
        <span class="input-group-btn">
          <button class="btn btn-primary btn-icon" type="button"
            ng-click="disp.campaignEndPopupOpen = !disp.campaignEndPopupOpen">
            <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span>
          </button>
        </span>
      </div>

      <label>
        Start Date if Activated
      </label>

      <div class="input-group">
        <input type="text" class="form-control" uib-datepicker-popup="dd-MMM-yyyy"
          ng-model-options="{timezone: 'Z'}"
          ng-model="editRoute._meta.firstTripDate"
          is-open="disp.firstTripPopupOpen">
        <span class="input-group-btn">
          <button class="btn btn-primary btn-icon" type="button"
            ng-click="disp.firstTripPopupOpen = !disp.firstTripPopupOpen">
            <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span>
          </button>
        </span>
      </div>
    </div>

    <div class="form-group form-inline">
      <h3>Tiers</h3>
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th></th>
            <th>Price</th>
            <th>Number of committers</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="tier in editRoute.notes.tier">
            <td>
              <button ng-disabled="editRoute.notes.tier.length <= 1"
              ng-click="removeTier($index)" class="btn btn-danger" type="button">
                <span class="glyphicon glyphicon-minus"></span>
              </button>
            </td>
            <td>
              <input type="number" class="form-control" step="0.01" ng-model="tier.price"/>
            </td>
            <td>
              <input type="number" class="form-control" ng-model="tier.pax" />
            </td>
          </tr>
        </tbody>
        <tfoot>
          <tr>
            <td colspan="3">
              <button ng-click="addTier()" class="btn btn-primary" type="button"
                 ng-disabled="editRoute.notes.tier.length >= 1">
                <span class="glyphicon glyphicon-plus"></span>
              </button>
            </td>
          </tr>
        </tfoot>
      </table>
    </div>
    <div class="form-group">
      <span ng-if="editRoute.tags.indexOf('lelong') == -1">
        This is not a crowdstart route
      </span>
      <button class="btn btn-primary" ng-disabled="editRoute.tags.indexOf('lelong') == -1">
        Save
      </button>
    </div>

    <hr/>

    <div class="form-group form-inline">
      <h3>Bidders</h3>
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th></th>
            <th>User</th>
            <th>Telephone</th>
            <th>Email</th>
            <th>Bid Date</th>
            <th>Bid Price</th>
            <th>Status</th>
            <th>Cancel</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="bid in bids" ng-class="{
            'not-live': bid.status !== 'bidded',
          }">
            <td>{{$index + 1}}</td>
            <td>{{bid.user.name}}</td>
            <td>{{bid.user.telephone}}</td>
            <td>{{bid.user.email}}</td>
            <td>{{bid.createdAt | date:'dd MMM yy HH:mm:ss':'+0800'}}</td>
            <td>{{bid.priceF | number:2}}</td>
            <td>{{bid.status}}</td>
            <td>
              <button class="btn btn-danger" ng-click="withdrawBid(bid)"
                  type="button">
                <span class="glyphicon glyphicon-trash"></span>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </form>
</div>
